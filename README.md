# In order to run the tests and use/view the API
Run the following:

`unset DATABASE_URL && DB_HOST=db DB_PASSWORD=password RAILS_ENV=test rails db:create db:migrate`

`rails test`

`DB_HOST=db DB_PASSWORD=password RAILS_ENV=test rails server -b 0.0.0.0 -p 3000`

# WORK ASSIGNMENTS:

Katie:
- User Model
- User Controller
- Expert Assignment Model
- Expert Profile Model
- Experts Controller
- Health Controller

Che:
- Message Model
- Messages Controller
- Conversation Model
- Conversations Controller
- Updates Controller
- Auth Controller

# DONE:

### User Model
- ActiveRecord model file
  - Attributes to pass in: username (string, unique & not null), password_digest (string, not null), last_active_at (datetime, like Time.current)
  - Attributes generated by default: id (bigint), created_at (datetime), updated_at (datetime)
- Database migration file
- Tests
  - Should not save user without username
  - Should not save two users with the same username
  - Should not save user without password
  - Should save valid user
  - Valid user's attributes should all exist
 
### User Controller
- UsersController file
  - Action for registering a new user
- Entry in the routes.rb file for the new controller action
- Tests
  - Registers valid user
  - Does not register user with a short password
  - Does not register user without username
 
### Expert Profile Model
- ActiveRecord model file
  - Attributes to pass in: user_id (bigint, not null & unique), bio (text), knowledge_base_links (json)
  - Attributes generated by default: id (bigint), created_at (datetime), updated_at (datetime)
- Database migration file
- Tests
  - Missing user_id
  - Duplicate user_id
  - Saves valid expert profile
  - user_id must be the id of a valid user

### Expert Assignment Model
- ActiveRecord model file
  - Attributes to pass in: conversation_id (bigint, not null), expert_id (bigint, not null), status (string, not null & default = "active"), assigned_at (datetime, not null), resolved_at (datetime)
  - Attributes generated by default: id (bigint), created_at (datetime), updated_at (datetime)
- Database migration file
- Tests
  - Missing conversation_id
  - Missing expert_id
  - Missing assigned_at
  - Default status is set to Active
  - Creating expert assignment with status value overwrites default value
  - Saves valid expert assignment

### HealthController
- No authentication neccessary
- HealthController file
  - Actions: show (just shows health status)
- Entry in the routes.rb file for actions
- Tests
  - GET /health returns ok status and timestamp

### Message Model
- ActiveRecord model file
  - Attributes to pass in: conversation_id (bigint, not null), sender_id (bigint, not null), sender_role (string, not null & enum: \[initiator, expert\], content (text, not null), is_read (boolean, not null & default = false)
  - Attributes generated by default: id (bigint), created_at (datetime), updated_at (datetime)
- Database migration file
- Tests

### Messages Controller
- Uses JWT for token based authentication
- MessagesController file
  - Actions: TO DO
- Entry in the routes.rb file for actions
- Tests

### Conversation Model
- ActiveRecord model file
  - Attributes to pass in: title (string, not null), status (string, not null & default = "waiting"), initiator_id (bigint, not null), assigned_expert_id (bigint, can be null), last_message_at (datetime)
  - Attributes generated by default: id (bigint), created_at (datetime), updated_at (datetime)
- Database migration file
- Tests

### Conversations Controller
- Uses JWT for token based authentication
- ConversationsController file
  - Actions: TO DO
- Entry in the routes.rb file for actions
- Tests

### Auth Controller
- Uses session cookie for authentication where needed (register and login do not require auth)
- AuthController file
  - Actions: TO DO
- Entry in the routes.rb file for actions
- Tests

### UpdatesController
- Users JWT for token based authentication
- UpdatesController file
  - Actions: TO DO
- Entry in the routes.rb file for actions
- Tests

### Expert Controller
- Users JWT for token based authentication
- ExpertController file
  - Actions: TO DO
- Entry in the routes.rb file for actions
- Tests

# TO DO: (in general order)
Test with frontend and make video!
